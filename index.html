
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>لعبة النقرة - JBT_YTT</title>
  <style>
    body {
      font-family: Arial;
      background: #121212;
      color: white;
      text-align: center;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      background-color: #1e1e1e;
      padding: 10px;
    }
    .top-bar button {
      background: #333;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 5px;
    }
    h1 { margin-top: 20px; }
    button {
      font-size: 18px;
      margin: 10px;
      padding: 10px 20px;
      border-radius: 8px;
      border: none;
      background-color: #2196F3;
      color: white;
      cursor: pointer;
    }
    #missionsBox {
      display: none;
      background: #222;
      border: 1px solid #555;
      padding: 15px;
      border-radius: 10px;
      text-align: left;
      margin: 10px auto;
      max-width: 400px;
    }
    #missionsBox ul {
      padding-left: 20px;
    }
    input {
      padding: 5px;
      border-radius: 5px;
      margin: 5px;
    }
    .click-effect {
      position: absolute;
      color: yellow;
      font-size: 20px;
      pointer-events: none;
      animation: fadeMove 1s forwards;
    }
    @keyframes fadeMove {
      0% { opacity: 1; transform: translateY(0); }
      100% { opacity: 0; transform: translateY(-30px); }
    }
  </style>
</head>
<body onclick="incrementByClick(event)">
  <div class="top-bar">
    <button onclick="toggleMissions()">المهام اليومية</button>
    <div>
      الاسم: <span id="playerName">---</span>
      <button onclick="changeName()">تغيير الاسم</button>
    </div>
  </div>

  <div id="missionsBox">
    <h4>المهام:</h4>
    <ul id="missionsList"></ul>
  </div>

  <h1>لعبة النقرة</h1>
  <h2>النقاط: <span id="points">0</span></h2>
  <h3>المرحلة: <span id="level">1</span></h3>

  <button onclick="incrementClick()">اضغط لجمع النقاط</button><br>
  <button onclick="buyMultiplier()">شراء مضاعف (<span id="multiplierCost">50</span>)</button>
  <button onclick="resetGame()">إعادة</button>

  <script>
    let points = 0;
    let multiplier = 1;
    let multiplierCost = 50;
    let level = 1;
    let playerName = localStorage.getItem("playerName") || "";

    const playerNameEl = document.getElementById("playerName");
    const pointsEl = document.getElementById("points");
    const levelEl = document.getElementById("level");
    const multiplierCostEl = document.getElementById("multiplierCost");

    function updateUI() {
      pointsEl.innerText = Math.floor(points);
      levelEl.innerText = level;
      multiplierCostEl.innerText = multiplierCost;
      playerNameEl.innerText = playerName || "---";
    }

    function promptForName() {
      let name = prompt("أدخل اسمك (لا يمكن تكرار الاسم):");
      if (!name || name.trim() === "") return;
      if (name === "JBT_YTT" || localStorage.getItem("name_" + name)) {
        alert("الاسم مأخوذ، اختر اسمًا آخر.");
        return promptForName();
      }
      playerName = name;
      localStorage.setItem("playerName", playerName);
      localStorage.setItem("name_" + playerName, true);
      updateUI();
    }

    function changeName() {
      localStorage.removeItem("name_" + playerName);
      localStorage.removeItem("playerName");
      promptForName();
    }

    function incrementClick() {
      points += multiplier;
      checkLevel();
      updateUI();
    }

    function incrementByClick(e) {
      if (e.target.tagName !== "BUTTON" && e.target.id !== "missionsBox") {
        points += multiplier;
        checkLevel();
        updateUI();
        showClickEffect(e.clientX, e.clientY);
      }
    }

    function showClickEffect(x, y) {
      const el = document.createElement("div");
      el.className = "click-effect";
      el.style.left = `${x}px`;
      el.style.top = `${y}px`;
      el.textContent = "+" + multiplier;
      document.body.appendChild(el);
      setTimeout(() => el.remove(), 1000);
    }

    function buyMultiplier() {
      if (points >= multiplierCost) {
        points -= multiplierCost;
        multiplier++;
        multiplierCost = Math.floor(multiplierCost * 1.8);
        updateUI();
      }
    }

    function checkLevel() {
      const levelThresholds = [100, 500, 1000, 5000, 10000, 25000, 100000, 500000, 1000000];
      for (let i = levelThresholds.length - 1; i >= 0; i--) {
        if (points >= levelThresholds[i]) {
          level = i + 2;
          return;
        }
      }
      level = 1;
    }

    function resetGame() {
      if (confirm("هل أنت متأكد من إعادة اللعبة؟")) {
        points = 0;
        multiplier = 1;
        multiplierCost = 50;
        level = 1;
        updateUI();
      }
    }

    function toggleMissions() {
      const box = document.getElementById("missionsBox");
      box.style.display = box.style.display === "none" ? "block" : "none";
      updateMissions();
    }

    function updateMissions() {
      const missions = [
        { text: "احصل على 100 نقطة", value: 100 },
        { text: "احصل على 1,000 نقطة", value: 1000 },
        { text: "اشترِ 3 مضاعفات", value: 3, type: "multiplier" },
        { text: "افتح المرحلة 5", value: 5, type: "level" },
      ];
      const ul = document.getElementById("missionsList");
      ul.innerHTML = "";
      missions.forEach(m => {
        const li = document.createElement("li");
        let achieved = false;
        if (!m.type) achieved = points >= m.value;
        else if (m.type === "multiplier") achieved = multiplier > m.value;
        else if (m.type === "level") achieved = level >= m.value;
        li.innerText = `${m.text} - ${achieved ? "✓" : "❌"}`;
        ul.appendChild(li);
      });
    }

    if (!playerName) promptForName();
    updateUI();
  </script>
</body>
</html>
